<style>
    .karmen-header {
        padding-left: 1em;
        padding-bottom: 10px;
        margin-bottom: 1em;
    }
    .karmen-header a {
        text-decoration: none;
        color: #000;
    }
    .karmen-block {
        border-top: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        padding-top: 2em;
    }
</style>

<div class="karmen-header">
    <a href="https://karmen.tech/">
        <h3>
            <div style="float: left; margin-right: 20px;">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25px" height="47px" viewBox="0 0 100 187" version="1.1">
                    <script xmlns="" id="custom-useragent-string-page-script"/>
                    <title>karmen-logo</title>
                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g id="karmen-logo" transform="translate(-4.000000, -5.000000)" fill="#EA262D" fill-rule="nonzero">
                            <path d="M21.016317,5 L38.265734,15.722611 L38.965035,65.13986 L52.484848,73.531469 L52.484848,71.200466 L69.501166,60.710956 L69.501166,56.981352 L86.983683,46.025641 L104,56.515152 L104,82.389277 L88.149184,92.412587 L88.149184,96.142191 L71.599068,106.631702 L71.599068,110.128205 L88.149184,120.617716 L88.149184,144.86014 L104,154.88345 L104,180.757576 L86.983683,191.247086 L69.734266,180.524476 L69.501166,156.048951 L52.951049,145.792541 L52.951049,121.083916 L38.965035,112.459207 L38.498834,139.498834 L21.249417,150.221445 L4,139.731935 L4,15.48951 L21.016317,5 Z M102.368298,157.447552 L88.149184,166.305361 L88.149184,188.682984 L102.368298,179.592075 L102.368298,157.447552 Z M86.983683,146.258741 L72.298368,155.582751 L86.983683,164.90676 L102.135198,155.582751 L86.983683,146.258741 Z M85.818182,122.482517 L71.599068,131.340326 L71.599068,153.951049 L85.818182,145.09324 L85.818182,122.482517 Z M36.867133,116.188811 L21.948718,125.04662 L21.948718,147.657343 L36.867133,138.799534 L36.867133,116.188811 Z M70.666667,111.526807 L55.515152,120.850816 L70.433566,129.941725 L85.585082,120.850816 L70.666667,111.526807 Z M21.948718,101.969697 L21.948718,122.715618 L36.867133,114.090909 L36.867133,111.060606 L21.948718,101.969697 Z M55.282051,98.240093 L55.282051,118.986014 L69.501166,110.128205 L69.501166,106.864802 L55.282051,98.240093 Z M71.599068,83.787879 L71.599068,104.7669 L85.818182,95.909091 L85.818182,92.412587 L71.599068,83.787879 Z M52.484848,77.494172 L38.965035,85.885781 L52.484848,94.277389 L52.484848,77.494172 Z M102.368298,58.846154 L88.149184,67.703963 L88.149184,90.314685 L102.368298,81.456876 L102.368298,58.846154 Z M37.566434,66.305361 L23.114219,75.39627 L23.114219,76.095571 L37.566434,84.72028 L52.484848,75.629371 L37.566434,66.305361 Z M69.501166,63.041958 L55.515152,71.666667 L69.501166,80.291375 L69.501166,63.041958 Z M36.867133,42.296037 L21.948718,51.386946 L21.948718,73.531469 L36.867133,64.67366 L36.867133,42.296037 Z M86.983683,47.890443 L72.065268,57.214452 L86.983683,66.305361 L101.668998,57.214452 L86.983683,47.890443 Z M36.167832,18.053613 L21.948718,26.911422 L21.948718,49.522145 L36.867133,40.198135 L36.167832,18.053613 Z M21.249417,6.864802 L6.331002,16.188811 L21.016317,25.27972 L35.934732,16.188811 L21.249417,6.864802 Z" id="red-frame"/>
                        </g>
                    </g>
                </svg>
            </div>
            <div>Karmen</div>
        </h3>
    </a>
</div>

{% if plugin_karmen_is_octoprint_compatible %}
<div class="karmen-block">
    <form class="form-horizontal">
        <p>
            You can get new Device key in Karmen Cloud.
            Once you are logged in <a href="https://next.karmen.tech/" target="_blank">Karmen</a>, click on "Add printer" and follow instructions
            to connect your Octoprint with Karmen.
        </p>
        <p>
            Weâ€™ll gladly answer all your questions or comments. Please get in touch at <a href="mailto:karmen@karmen.tech">karmen@karmen.tech</a> or visit our <a href="https://docs.karmen.tech/" target="_blank" />documentation</a>.
        </p>
        <div class="control-group">
            <label class="control-label">{{ _('Device key:') }}</label>
            <div class="controls">
                <input type="text" class="input-block-level" data-bind="value: settings.plugins.karmen.karmen_key">
            </div>
        </div>

        <div>
            <div><small><a href="#" class="muted" data-bind="toggleContent: { class: 'fa-caret-right fa-caret-down', parent: '.form-horizontal', container: '.hide' }"><i class="fas
            fa-caret-right"></i> Advanced options</a></small></div>
            <div class="hide">
                <div style="margin-top: 10px; margin-bottom: 10px; background: #ff9999; padding: 5px;">
                    <strong>Don't modify unless you know what are you doing.</strong>
                </div>
                <div class="control-group">
                    <label class="control-label">{{ _('Websocket server address:') }}</label>
                    <div class="controls">
                        <input type="text" class="input-block-level" data-bind="value: settings.plugins.karmen.ws_server">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">{{ _('Path whitelist:') }}</label>
                    <div class="controls">
                        <input type="text" class="input-block-level" data-bind="value: settings.plugins.karmen.path_whitelist">
                        <small>separate with ;</small>
                    </div>
                </div>
                <div>
                    <label class="control-label">{{ _('Send error tracking data to sentry:') }}</label>
                    <div class="controls">
                        <select name="sentry_opt" id="sentry-select" data-bind="value: settings.plugins.karmen.sentry_opt">
                            <option value="out">{{ _('Disabled') }}</option>
                            <option value="in">{{ _('Enabled') }}</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

    </form>
</div>

<div class="karmen-block">
    <h4>Confirm you understand what will happen</h4>
    <p>By connecting your Octoprint installation to Karmen Cloud, you confirm you understand that Karmen Cloud will acquire full control over your device.</p>

    <h4>API key security</h4>   
    <p>Never share your API or device keys with ANYONE.</p>
    <p>Please follow our guidelines and do not use the primary Octoprint key when setting up the Karmen plugin. Rather, create a special key for that purpose as described in our <a href="https://docs.karmen.tech/"/>documentation</a></p>
</div>
{% else %}
<div class=karmen-block">
    <h4>This version is incompatible with Octoprint 1.7 and lower</h4>
    <p>You can:</p>
    <ul>
    <li>Upgrade Octoprint to version 1.8 or higher (highly recommended)</li>
    or
    <li>Install version 0.4.0 of Karmen Connector</li>
    </ul>
    <p>To install version 0.4.0 go to <b>Octoprint Settings</b> -> <b>Plugin Manager</b> -> <b>+ Get more</b> and to <b>... from URL</b> field enter
        <code>https://github.com/fragaria/karmen-octoprint-plugin/archive/refs/tags/0.4.0-legacy.zip</code> and click <b>Install</b>
    </p>
</div>
{% endif %}